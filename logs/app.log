[watermill] 2024/09/15 17:17:03.459721 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:17:03.459891 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:17:03.459941 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:17:03.459982 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:17:03.460055 schema.go:28: 	level=INFO  msg="Initializing subscriber schema" query="[CREATE TABLE IF NOT EXISTS `watermill_mahjongStruct.GameUpdated` (
`offset` BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
`uuid` VARCHAR(36) NOT NULL,
`created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
`payload` JSON DEFAULT NULL,
`metadata` JSON DEFAULT NULL
);  
				CREATE TABLE IF NOT EXISTS `watermill_offsets_mahjongStruct.GameUpdated` (
				consumer_group VARCHAR(255) NOT NULL,
				offset_acked BIGINT,
				offset_consumed BIGINT NOT NULL,
				PRIMARY KEY(consumer_group)
			) ]" subscriber_id=01J7TFHB33F6Y3D7TCX5MV0EEN 
[watermill] 2024/09/15 17:17:03.460063 schema.go:28: 	level=INFO  msg="Initializing subscriber schema" query="[CREATE TABLE IF NOT EXISTS `watermill_mahjongStruct.GameStateUpdated` (
`offset` BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
`uuid` VARCHAR(36) NOT NULL,
`created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
`payload` JSON DEFAULT NULL,
`metadata` JSON DEFAULT NULL
);  
				CREATE TABLE IF NOT EXISTS `watermill_offsets_mahjongStruct.GameStateUpdated` (
				consumer_group VARCHAR(255) NOT NULL,
				offset_acked BIGINT,
				offset_consumed BIGINT NOT NULL,
				PRIMARY KEY(consumer_group)
			) ]" subscriber_id=01J7TFHB335TM7JB0P4FQ9JA3P 
[watermill] 2024/09/15 17:17:03.507465 router.go:606: 	level=INFO  msg="Starting handler" subscriber_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:17:03.507503 router.go:606: 	level=INFO  msg="Starting handler" subscriber_name=UpdateGame topic=mahjongStruct.GameUpdated 
time="2024-09-15T17:17:07+08:00" level=info msg="sending InitStreamResponse"
[watermill] 2024/09/15 17:18:34.359326 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:18:34.359514 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:18:34.359547 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:18:34.359639 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:18:34.359707 schema.go:28: 	level=INFO  msg="Initializing subscriber schema" query="[CREATE TABLE IF NOT EXISTS `watermill_mahjongStruct.GameStateUpdated` (
`offset` BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
`uuid` VARCHAR(36) NOT NULL,
`created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
`payload` JSON DEFAULT NULL,
`metadata` JSON DEFAULT NULL
);  
				CREATE TABLE IF NOT EXISTS `watermill_offsets_mahjongStruct.GameStateUpdated` (
				consumer_group VARCHAR(255) NOT NULL,
				offset_acked BIGINT,
				offset_consumed BIGINT NOT NULL,
				PRIMARY KEY(consumer_group)
			) ]" subscriber_id=01J7TFM3VQYNTXSXXFTTNZAM3T 
[watermill] 2024/09/15 17:18:34.359641 schema.go:28: 	level=INFO  msg="Initializing subscriber schema" query="[CREATE TABLE IF NOT EXISTS `watermill_mahjongStruct.GameUpdated` (
`offset` BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
`uuid` VARCHAR(36) NOT NULL,
`created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
`payload` JSON DEFAULT NULL,
`metadata` JSON DEFAULT NULL
);  
				CREATE TABLE IF NOT EXISTS `watermill_offsets_mahjongStruct.GameUpdated` (
				consumer_group VARCHAR(255) NOT NULL,
				offset_acked BIGINT,
				offset_consumed BIGINT NOT NULL,
				PRIMARY KEY(consumer_group)
			) ]" subscriber_id=01J7TFM3VQWSJ34XEVFH6AH0YY 
[watermill] 2024/09/15 17:18:34.432273 router.go:606: 	level=INFO  msg="Starting handler" subscriber_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:18:34.432330 router.go:606: 	level=INFO  msg="Starting handler" subscriber_name=UpdateGame topic=mahjongStruct.GameUpdated 
time="2024-09-15T17:18:38+08:00" level=info msg="sending InitStreamResponse"
[watermill] 2024/09/15 17:20:41.818368 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:20:41.818515 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:20:41.818581 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:21:57.953684 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:21:57.953851 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:21:57.953885 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:21:57.953934 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:22:25.452483 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:22:25.452656 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:22:25.452696 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:22:25.452727 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:29:21.144976 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:29:21.145130 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:29:21.145184 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:29:21.145209 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:38:46.239786 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:38:46.240022 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:38:46.240075 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:38:46.240168 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:38:51.628846 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:38:51.630054 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:38:51.630259 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:38:51.630513 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:39:26.096081 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:39:26.096219 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:39:26.096264 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:39:26.096299 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:42:44.340071 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:42:44.340296 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:42:44.340347 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:42:45.305110 router.go:268: 	level=INFO  msg="Adding handler" handler_name=UpdateGame topic=mahjongStruct.GameUpdated 
[watermill] 2024/09/15 17:42:45.305530 router.go:268: 	level=INFO  msg="Adding handler" handler_name=fanout-mahjongStruct.GameStateUpdated topic=mahjongStruct.GameStateUpdated 
[watermill] 2024/09/15 17:42:45.305613 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
[watermill] 2024/09/15 17:42:45.305718 router.go:402: 	level=INFO  msg="Running router handlers" count=1 
